
## (a)部分 二项分布的基础模拟

```r
binom_var <- rbinom(n = 1000, size = 100, prob = 0.75)
```
**含义：**
* 模拟1000次 Bin(100, 0.75) 的抽样
* rbinom(n, size, prob): 生成n个二项分布随机数
	* n: 生成的随机数个数
	* size: 每次试验的次数
	* prob: 成功概率

```r
hist(binom_var, prob = TRUE, xlim = c(0, 100), ylim = c(0, 0.15),
	 main = "Histogram of 1000 draws from Bin(100, 0.75)",
	 cex_main = 0.7, breaks = 20, xlab = "")
```
**含义:**
* hist(): 绘制概率密度直方图
	* prob = TRUE: y轴显示密度而非频数
	* xlim/ylim: 设置坐标轴范围
	* main: 图像标题
	* breaks: 设置分组数
	* cex.main: 标题字体大小
	* xlab: x轴标题

```r
curve(dnorm(x, mean = 75, sd = sqrt(0.75 * 0.25 * 100)),
	  lwd = 2, add = TRUE, col = 'red')
```
**含义:** 叠加正态分布密度曲线
* dnorm(x, mean, sd): 正态分布密度函数
	* 参数来源(对于二项分布): 
		* E(X) = np = 1000 * 0.75 = 75
		* Var(X) = np(1-p) = 18.75
		* sd = $\sqrt{Var}$
	* lwd: 曲线粗细
	* add = TRUE: 添加到现有图形上


## (b)部分 伯努利分布的样本均值

```r
bernoulli_var <- replicate(1000, mean(rbinom(100, 1, 0.75)))
```
* **函数:**
	* replicate(n, expr): 重复执行表达式n次
	* rbinom(100, 1, p): 100次伯努利试验
	* mean(): 计算样本均值
* **过程:**
	* 每次抽100个 B(1, 0.75) 的样本
	* 计算这100个样本的均值
	* 重复1000次

```r
bernoulli_var <- bernoulli_var * 100
```
* **含义:** 将均值转换为总和 (sum = mean * n)

```r
hist(bernoulli_var, prob = TRUE, xlim = c(1, 100), ylim = c(0, 0.15),
	 main = "Histogram of 1000 sample means (n = 100) of B(0.75) multiplied by 100",
	 cex.main = 0.7,
	 breaks = 20, xlab = "")
	 
curve(dnorm(x, mean = 75, sd = sqrt(0.75 * 0.25 * 100)),
	  lwd = 2, add = TRUE, col = 'red')
```

#### 通用CLT模拟函数 (二项分布)
```r
CLT_sim_binomial <- function(n, p, r) {
	samples <- rbinom(r, n, p)
	
	#生成标准化样本
	x_mean <- (n * p)
	x_sd <- sqrt(n * p * (1 - p))
	#标准化公式: Z = (X - E(X)) / \sqrt{Var(X)}
	sample_standardized <- (samples - x_mean) / x_sd
	
	#绘图
	hist(sample_standardized, prob = TRUE, xlim = c(-5, 5),
		 breaks = seq(-50, 50, by = 0.25),    #生成分组边界
		 main = paste("n =", n, "p =", p), xlab = "")
	
	#叠加标准正态曲线
	curve(dnorm(x, mean = 0, sd = 1), lwd = 2, add = TRUE, col = 'red')
}
```


## (c)部分 通用CLT模拟函数 (指数分布)
```r
CLT_sim_exp <- function(n, lambda, r) {
	sample_means <- rep(0, r)
	
	#循环版本
	for(i in 1:r) {
	samples <- rexp(n, lambda)
	sample_means[i] <- mean(samples)
	}
	
	#指数分布参数
	x_mean <- 1/lambda
	x_var <- 1/(lambda^2)
	sample_normalized <- (sample_means - x_mean) / sqrt(x_var / n)
	
	#绘图
	hist(sample_normalized, prob = TRUE, xlim = c(-5, 5), xlab = "",
       main = paste("n =", n, "lambda =", lambda),
       breaks = seq(-50, 50, by = 0.25))
       
    #叠加标准正态曲线
    curve(dnorm(x, mean = 0, sd = 1), lwd = 2, add = TRUE, col = 'red')
}
```

```r
par(mfrow = c(3, 2), mar = c(4, 4, 1, 1))
CLT_sim_binomial(3, 0.9, 10000)
CLT_sim_binomial(3, 0.5, 10000)
CLT_sim_binomial(10, 0.9, 10000)
CLT_sim_binomial(10, 0.5, 10000)
CLT_sim_binomial(20000, 0.001, 10000)
CLT_sim_binomial(2000, 0.5, 10000)
```
* **测试不同参数:**
	* par(mfrow = c(3, 2)): 设置3行2列的多图布局
	* mar: 设置边距